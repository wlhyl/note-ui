<app-alert [(alerts)]="message"></app-alert>


<div class="container">
  <h2> 文章 </h2>

  <div class="row">
    <div class="col">
      <a (click)="showArticles(false)" class="mx-1" [ngClass]="{active: !showDeleted}">
      全部({{articles.length}})</a>
      |
      <a clas="mx-1" [ngClass]="{active: showDeleted}" (click)="showArticles(true)">
      回收站({{deletedArticles.length}})</a>
      |
      <a (click)="reload()" class="mx-1">
        @if (reloading) {
          刷新中...
          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        } @else {
          刷新<i class="bi bi-arrow-clockwise"></i>
        }
      </a>
    </div>
  </div>
  <div class="col">
    <button type="button" class="btn btn-outline-danger btn-sm" (click)="deleteArticles()"
      [disabled]="deletingOrRecovering">{{showDeleted? "永久删除" :
    "删除"}}</button>
    @if (showDeleted) {
      <button type="button" class="btn btn-outline-danger btn-sm ms-2" (click)="recoveryArticles()"
      [disabled]="deletingOrRecovering">还原</button>
    }
  </div>
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th scope="col">
          <input class="form-check-input" type="checkbox" id="article_all" value="-1"
            [(ngModel)]="checkAllArticles">
        </th>
        <th scope="col">标题</th>
        <th scope="col">私有</th>
        <th scope="col">分类</th>
        <th scope="col">标签</th>
        <th scope="col">创建时间</th>
        <th scope="col">最后更新时间</th>
      </tr>
    </thead>
    <tbody>
      @for (item of filtedArticles; track item) {
        <tr>
          <td>
            <input class="form-check-input" type="checkbox" id="article{{item.article.id}}"
              value="{{item.article.id}}" [(ngModel)]="item.checked">
          </td>
          <td>
            <a routerLink="/blog/articles/{{item.article.id}}">{{item.article.title}}</a>
          </td>
          <td>
            <a role="button" class="ms-1" (click)="filteArticlesByPrivate(item.article.private)">
            {{item.article.private? "是" : "否" }}</a>
          </td>
          <td>
            <a role="button" class="ms-1" (click)="filteArticlesByCategoryId(item.article.category.id)">
            {{item.article.category.name}}</a>
          </td>
          <td>
            @for (tag of item.article.tags; track tag; let i = $index) {
              <a role="button" class="ms-1" (click)="filteArticlesByTagId(tag.id)">{{tag.name}}</a>
              @if (i != item.article.tags.length-1) {
                <span>、</span>
              }
            }
          </td>
          <td>{{item.article.create_date}}</td>
          <td> {{item.article.last_update_date}} </td>
        </tr>
      }

    </tbody>
  </table>